@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix scs: <http://snowflake.com/containerservices#> .

# Role Setup Steps
scs:CreateRole rdf:type scs:Step ;
    scs:order 1 ;
    scs:creates scs:SPCSServiceRole .

scs:GrantWarehousePrivileges rdf:type scs:Step ;
    scs:order 1.1 ;
    scs:requires scs:CreateRole ;
    scs:grants scs:WarehouseUsage .

scs:GrantDatabasePrivileges rdf:type scs:Step ;
    scs:order 1.2 ;
    scs:requires scs:CreateRole ;
    scs:grants scs:DatabaseUsage .

scs:GrantSchemaPrivileges rdf:type scs:Step ;
    scs:order 1.3 ;
    scs:requires scs:CreateRole ;
    scs:grants scs:SchemaUsage .

scs:GrantTablePrivileges rdf:type scs:Step ;
    scs:order 1.4 ;
    scs:requires scs:CreateRole ;
    scs:grants scs:TableRead, scs:TableWrite .

# Main Execution Flow
scs:CreateImageRepository rdf:type scs:Step ;
    scs:order 2 ;
    scs:requires scs:SPCSServiceRole .

scs:CreateStages rdf:type scs:Step ;
    scs:order 3 ;
    scs:requires scs:SPCSServiceRole .

scs:CreateComputePool rdf:type scs:Step ;
    scs:order 4 ;
    scs:requires scs:SPCSServiceRole .

scs:BuildAndPushContainer rdf:type scs:Step ;
    scs:order 5 ;
    scs:requires scs:CreateImageRepository .

scs:UploadFiles rdf:type scs:Step ;
    scs:order 6 ;
    scs:requires scs:CreateStages .

scs:CreateExternalAccess rdf:type scs:Step ;
    scs:order 7 ;
    scs:requires scs:SPCSServiceRole .

scs:CreateService rdf:type scs:Step ;
    scs:order 8 ;
    scs:requires scs:CreateComputePool ;
    scs:requires scs:BuildAndPushContainer ;
    scs:requires scs:UploadFiles ;
    scs:requires scs:CreateExternalAccess .

scs:CreateFunctions rdf:type scs:Step ;
    scs:order 9 ;
    scs:requires scs:CreateService . 